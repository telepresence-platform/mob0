<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>cocosoco map</title>

    <style>
    html { height: 100% }
    body { height: 100% }
    #map { height: 100%; width: 100%}
    </style>
  </head>

  <body>
    <div id="map"></div>

    <script type="text/javascript">
    const AVAILABLE_LOCATIONS = [
      {
        position: { lat: 35.7137109, lng: 139.7600179 },
        title: "大銀杏",
        cocosocoURL: "https://telepresence-platform.github.io/cocosoco?key=99506149-de1f-4bee-a7d3-b47837e39a53&room=%E5%A4%A7%E9%8A%80%E6%9D%8F&network=sfu",
        mapURL: `https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d404.9385617462501!2d139.76001785468608!3d35.713710945067376!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188d0647b50459%3A0xec9d286f8a66842b!2z5aSn6YqA5p2P!5e0!3m2!1sja!2sjp!4v1598078475251!5m2!1sja!2sjp`,
      },
    ];

    function initMap() {
      const options = {
        zoom: 15,
        center: { lat: 35.7139014, lng: 139.7601034 },
      };
      const map = new google.maps.Map(document.getElementById("map"), options);

      for (const { position, title, cocosocoURL, mapURL } of AVAILABLE_LOCATIONS) {
        const marker = new google.maps.Marker({
          position: position,
          map: map,
          title: title,
          icon: "pin_leg.png",
        });
        marker.addListener("click", () => {
          window.open(createURL(cocosocoURL, mapURL), "newtab");
        });
      }
    }

    function createURL(cocosocoURL, mapURL) {
      return `run.html?cocosoco=${encodeURIComponent(cocosocoURL)}&map=${encodeURIComponent(mapURL)}`;
    }
    </script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCvTrE86BJIl6K7VQxyqsgz5hhBIQ5XnCQ&callback=initMap">
    </script>
  </body>
</html>
